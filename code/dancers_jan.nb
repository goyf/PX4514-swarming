(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12708,        295]
NotebookOptionsPosition[     11802,        274]
NotebookOutlinePosition[     12145,        289]
CellTagsIndexPosition[     12102,        286]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "10"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"r", ":=", 
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "n"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"f", ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "/", 
          RowBox[{"(", 
           RowBox[{".01", "+", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"#", ".", "#"}], "]"}]}], ")"}]}], ")"}], "&"}], "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "-", "x"}], ")"}]}], "&"}]}], ";"}],
    "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"f", ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0.2", "*", "#"}], ")"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "-", "x"}], ")"}]}], "&"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"s", ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r1", "=", "r"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"[", "r1", "]"}], "]"}], "=", "r"}], ";", 
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"[", "r1", "]"}], "]"}], "=", "r"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p", ",", "q"}], "}"}], "=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PointSize", "[", "0.007", "]"}], ",", 
     RowBox[{"Dynamic", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"r", "<", "100"}], ",", "s"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Point", "[", 
        RowBox[{"x", "=", 
         RowBox[{
          RowBox[{"0.995", " ", "x"}], "+", 
          RowBox[{"0.02", " ", 
           RowBox[{"f", "[", "p", "]"}]}], "-", 
          RowBox[{"0.04", " ", 
           RowBox[{"f", "[", "q", "]"}]}]}]}], "]"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "2"}]}], 
  "]"}], "\[IndentingNewLine]", "x", "\[IndentingNewLine]", 
 RowBox[{"x", "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"EuclideanDistance", "[", 
  RowBox[{
   RowBox[{"x", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"x", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistanceMatrix", "[", "x", "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"GeometricMean", "[", "x", "]"}]}], "Input",
 CellChangeTimes->{{3.7608952917825413`*^9, 3.760895480936194*^9}, {
  3.7608955600751677`*^9, 3.760895560488917*^9}, {3.7608960360403757`*^9, 
  3.760896063050812*^9}, {3.760896111677374*^9, 3.7608961118842545`*^9}, {
  3.7608961511373143`*^9, 3.7608961720192966`*^9}, {3.7608962940945845`*^9, 
  3.76089629434544*^9}, {3.7608963652218113`*^9, 3.76089638137563*^9}, {
  3.760896613047104*^9, 3.7608966156246204`*^9}, {3.760896805414939*^9, 
  3.760896913032525*^9}, {3.7608969575129385`*^9, 3.760896971877672*^9}, {
  3.7608970021122775`*^9, 3.760897053198364*^9}, {3.7608970990834618`*^9, 
  3.7608971034519477`*^9}, {3.76089725712586*^9, 3.760897258459095*^9}, {
  3.760897413512364*^9, 3.7608974262210503`*^9}, {3.7608974620567627`*^9, 
  3.760897466413255*^9}, {3.7608975393259783`*^9, 3.7608975510712385`*^9}, {
  3.7608979603878016`*^9, 3.7608979654598846`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"5971e84c-469c-4b9c-ac5e-5e0017d851dc"],

Cell[BoxData[
 GraphicsBox[
  {PointSize[0.007], 
   DynamicBox[Typeset`ToBoxes[
    If[$CellContext`r < 100, $CellContext`s]; 
     Point[$CellContext`x = 
       0.995 $CellContext`x + 0.02 $CellContext`f[$CellContext`p] - 
        0.04 $CellContext`f[$CellContext`q]], StandardForm, Graphics],
    ImageSizeCache->{{0., 0.}, {0., 0.}}]},
  PlotRange->2]], "Output",
 CellChangeTimes->{{3.760895296409891*^9, 3.7608953753329697`*^9}, {
   3.760895405806432*^9, 3.7608954811460867`*^9}, 3.760895561088585*^9, {
   3.7608960391305776`*^9, 3.7608960705750146`*^9}, 3.760896112126116*^9, {
   3.7608961625257597`*^9, 3.7608961723301315`*^9}, 3.7608962952159386`*^9, {
   3.760896376135579*^9, 3.7608963818243713`*^9}, 3.7608966164501457`*^9, 
   3.7608968059536333`*^9, {3.76089683931295*^9, 3.7608969132863913`*^9}, {
   3.76089696446194*^9, 3.7608969721515007`*^9}, {3.760897002313142*^9, 
   3.7608970534342422`*^9}, 3.760897104116579*^9, 3.7608972589048367`*^9, {
   3.7608974160628953`*^9, 3.76089742707156*^9}, 3.760897468052314*^9, 
   3.76089755189276*^9, 3.760897966283409*^9, 3.760947837486178*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"542facf1-b4a2-4cc3-a95b-816aec143963"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.4782778560545098`", ",", "0.7940384589339997`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.344077479090767`", ",", 
     RowBox[{"-", "0.7927523388901889`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6912888841692073`", ",", "0.09809861794432928`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6486923459510958`", ",", "0.2784450646953798`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9520569348499297`", ",", "0.8987032340576424`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.8184832533971278`"}], ",", 
     RowBox[{"-", "0.5339201655439716`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.8393489606977678`"}], ",", 
     RowBox[{"-", "0.7189316489760782`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7056226069468785`"}], ",", 
     RowBox[{"-", "0.7876264179349888`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.2252397229800307`"}], ",", 
     RowBox[{"-", "0.5854051646598988`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.06101037947261334`", ",", "0.7993324116463527`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.760895296409891*^9, 3.7608953753329697`*^9}, {
   3.760895405806432*^9, 3.7608954811460867`*^9}, 3.760895561088585*^9, {
   3.7608960391305776`*^9, 3.7608960705750146`*^9}, 3.760896112126116*^9, {
   3.7608961625257597`*^9, 3.7608961723301315`*^9}, 3.7608962952159386`*^9, {
   3.760896376135579*^9, 3.7608963818243713`*^9}, 3.7608966164501457`*^9, 
   3.7608968059536333`*^9, {3.76089683931295*^9, 3.7608969132863913`*^9}, {
   3.76089696446194*^9, 3.7608969721515007`*^9}, {3.760897002313142*^9, 
   3.7608970534342422`*^9}, 3.760897104116579*^9, 3.7608972589048367`*^9, {
   3.7608974160628953`*^9, 3.76089742707156*^9}, 3.760897468052314*^9, 
   3.76089755189276*^9, 3.760897966283409*^9, 3.76094783751416*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"b85dc081-a745-47cb-ae47-18f8dfe33610"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.4782778560545098`", ",", "0.7940384589339997`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.760895296409891*^9, 3.7608953753329697`*^9}, {
   3.760895405806432*^9, 3.7608954811460867`*^9}, 3.760895561088585*^9, {
   3.7608960391305776`*^9, 3.7608960705750146`*^9}, 3.760896112126116*^9, {
   3.7608961625257597`*^9, 3.7608961723301315`*^9}, 3.7608962952159386`*^9, {
   3.760896376135579*^9, 3.7608963818243713`*^9}, 3.7608966164501457`*^9, 
   3.7608968059536333`*^9, {3.76089683931295*^9, 3.7608969132863913`*^9}, {
   3.76089696446194*^9, 3.7608969721515007`*^9}, {3.760897002313142*^9, 
   3.7608970534342422`*^9}, 3.760897104116579*^9, 3.7608972589048367`*^9, {
   3.7608974160628953`*^9, 3.76089742707156*^9}, 3.760897468052314*^9, 
   3.76089755189276*^9, 3.760897966283409*^9, 3.76094783751716*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"8907a4c7-e671-4833-b9f0-20a3f95ab67f"],

Cell[BoxData["1.5924555809305123`"], "Output",
 CellChangeTimes->{{3.760895296409891*^9, 3.7608953753329697`*^9}, {
   3.760895405806432*^9, 3.7608954811460867`*^9}, 3.760895561088585*^9, {
   3.7608960391305776`*^9, 3.7608960705750146`*^9}, 3.760896112126116*^9, {
   3.7608961625257597`*^9, 3.7608961723301315`*^9}, 3.7608962952159386`*^9, {
   3.760896376135579*^9, 3.7608963818243713`*^9}, 3.7608966164501457`*^9, 
   3.7608968059536333`*^9, {3.76089683931295*^9, 3.7608969132863913`*^9}, {
   3.76089696446194*^9, 3.7608969721515007`*^9}, {3.760897002313142*^9, 
   3.7608970534342422`*^9}, 3.760897104116579*^9, 3.7608972589048367`*^9, {
   3.7608974160628953`*^9, 3.76089742707156*^9}, 3.760897468052314*^9, 
   3.76089755189276*^9, 3.760897966283409*^9, 3.7609478375301514`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"d3c0e204-7dcc-4060-b230-fcb9cd72dffa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "1.5924555809305123`", ",", "0.7278090136671902`", ",", 
   "0.5430263773972813`", ",", "0.4852023605217924`", ",", 
   "1.8560882207782223`", ",", "2.006294837668226`", ",", 
   "1.9756730724023888`", ",", "1.5484836759502782`", ",", 
   "0.4173010579286184`"}], "}"}]], "Output",
 CellChangeTimes->{{3.760895296409891*^9, 3.7608953753329697`*^9}, {
   3.760895405806432*^9, 3.7608954811460867`*^9}, 3.760895561088585*^9, {
   3.7608960391305776`*^9, 3.7608960705750146`*^9}, 3.760896112126116*^9, {
   3.7608961625257597`*^9, 3.7608961723301315`*^9}, 3.7608962952159386`*^9, {
   3.760896376135579*^9, 3.7608963818243713`*^9}, 3.7608966164501457`*^9, 
   3.7608968059536333`*^9, {3.76089683931295*^9, 3.7608969132863913`*^9}, {
   3.76089696446194*^9, 3.7608969721515007`*^9}, {3.760897002313142*^9, 
   3.7608970534342422`*^9}, 3.760897104116579*^9, 3.7608972589048367`*^9, {
   3.7608974160628953`*^9, 3.76089742707156*^9}, 3.760897468052314*^9, 
   3.76089755189276*^9, 3.760897966283409*^9, 3.760947838639527*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"3649bc42-3ee0-4f2b-835f-6dc569dbb5d1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.4645442984422577`", ",", 
   RowBox[{"0.5154338324735481`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.16747460427546795`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.760895296409891*^9, 3.7608953753329697`*^9}, {
   3.760895405806432*^9, 3.7608954811460867`*^9}, 3.760895561088585*^9, {
   3.7608960391305776`*^9, 3.7608960705750146`*^9}, 3.760896112126116*^9, {
   3.7608961625257597`*^9, 3.7608961723301315`*^9}, 3.7608962952159386`*^9, {
   3.760896376135579*^9, 3.7608963818243713`*^9}, 3.7608966164501457`*^9, 
   3.7608968059536333`*^9, {3.76089683931295*^9, 3.7608969132863913`*^9}, {
   3.76089696446194*^9, 3.7608969721515007`*^9}, {3.760897002313142*^9, 
   3.7608970534342422`*^9}, 3.760897104116579*^9, 3.7608972589048367`*^9, {
   3.7608974160628953`*^9, 3.76089742707156*^9}, 3.760897468052314*^9, 
   3.76089755189276*^9, 3.760897966283409*^9, 3.760947838644523*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"3d5f1ddd-548e-4a61-8be5-faa1eb26e5a0"]
}, Open  ]]
},
WindowSize->{1440, 727},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4020, 115, 276, "Input",ExpressionUUID->"5971e84c-469c-4b9c-ac5e-5e0017d851dc"],
Cell[4603, 139, 1184, 20, 377, "Output",ExpressionUUID->"542facf1-b4a2-4cc3-a95b-816aec143963"],
Cell[5790, 161, 2011, 43, 52, "Output",ExpressionUUID->"b85dc081-a745-47cb-ae47-18f8dfe33610"],
Cell[7804, 206, 927, 14, 32, "Output",ExpressionUUID->"8907a4c7-e671-4833-b9f0-20a3f95ab67f"],
Cell[8734, 222, 865, 11, 32, "Output",ExpressionUUID->"d3c0e204-7dcc-4060-b230-fcb9cd72dffa"],
Cell[9602, 235, 1152, 18, 32, "Output",ExpressionUUID->"3649bc42-3ee0-4f2b-835f-6dc569dbb5d1"],
Cell[10757, 255, 1029, 16, 32, "Output",ExpressionUUID->"3d5f1ddd-548e-4a61-8be5-faa1eb26e5a0"]
}, Open  ]]
}
]
*)

