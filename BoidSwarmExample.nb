(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16645,        418]
NotebookOptionsPosition[     16018,        400]
NotebookOutlinePosition[     16361,        415]
CellTagsIndexPosition[     16318,        412]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "100"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Number", " ", "of", " ", "entities"}], "*)"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", ":=", 
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "n"}], "}"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "r", " ", "is", " ", "a", " ", "function", " ", "that", " ", "returns", 
    " ", "a", " ", "random", " ", "entity"}], "*)"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "/", 
         RowBox[{"(", 
          RowBox[{".01", "+", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"Dot", "[", 
             RowBox[{"#", ",", "#"}], "]"}], "]"}]}], ")"}]}], ")"}], "&"}], "/@",
       " ", 
      RowBox[{"(*", 
       RowBox[{"Divide", " ", "each", " ", "vector", " ", 
        RowBox[{"(", 
         RowBox[{"from", " ", "next", " ", "line"}], ")"}], " ", "by", " ", 
        RowBox[{"(", 
         RowBox[{".01", " ", "+", " ", 
          RowBox[{
           RowBox[{"it", "'"}], "s", " ", "length"}]}], ")"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "-", "x"}], ")"}]}], "&"}]}], ";"}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{
   "An", " ", "array", " ", "of", " ", "vectors", " ", "from", " ", "every", 
    " ", "point", " ", "to", " ", "a", " ", "selected", " ", "point"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "function", " ", "f", " ", "returns", " ", "an", " ", "array",
      " ", "of", " ", 
     RowBox[{"vectors", ".", " ", "These"}], " ", "vectors", " ", "point", 
     " ", "from", " ", "every", " ", "entity", " ", "towards", " ", "a", " ", 
     "specified", " ", 
     RowBox[{"entity", ".", " ", "The"}], " ", "magnitude", " ", "of", " ", 
     "these", " ", "vectors", " ", "is", " ", "slightly", " ", "less", " ", 
     "than", " ", "that", " ", "of", " ", "a", " ", "unit", " ", "vector"}], 
    ",", " ", 
    RowBox[{
    "and", " ", "tends", " ", "to", " ", "zero", " ", "as", " ", "the", " ", 
     "distance", " ", "between", " ", "entities", " ", "gets", " ", 
     "smaller"}]}], "*)"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s", ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r1", "=", "r"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "r1", "]"}], "]"}], "=", "r"}], ";", 
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"[", "r1", "]"}], "]"}], "=", "r"}]}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"for", " ", "a", " ", "random", " ", "entity", " ", 
     RowBox[{"(", 
      RowBox[{
      "the", " ", "same", " ", "random", " ", "element", " ", "in", " ", 
       "the", " ", "p", " ", "and", " ", "q", " ", "lists"}], ")"}]}], ",", 
    " ", 
    RowBox[{
    "s", " ", "is", " ", "a", " ", "function", " ", "to", " ", "pick", " ", 
     "a", " ", "new", " ", "\"\<friend\>\"", " ", "p", " ", "and", " ", 
     "\"\<enemy\>\"", " ", "q"}]}], "*)"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "x", " ", "is", " ", "an", " ", "array", " ", "of", " ", "random", " ", 
    "real", " ", "numbers", " ", "in", " ", "the", " ", "range", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ".", " ", "There"}], " ", "are",
     " ", "two", " ", "array", " ", "elements", " ", "for", " ", "each", " ", 
    RowBox[{"entity", ".", " ", "These"}], " ", "are", " ", "the", " ", 
    "initial", " ", "coordinates", " ", "of", " ", "each", " ", 
    RowBox[{"entity", "."}]}], "*)"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", "q"}], "}"}], "=", 
    RowBox[{"RandomInteger", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "n"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "p", " ", "and", " ", "q", " ", "are", " ", "random", " ", "entities", " ",
     "at", " ", "initialisation"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"leader", "=", 
   RowBox[{"{", 
    RowBox[{"0.0", ",", "0.0"}], "}"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Graphics", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PointSize", "[", "0.007", "]"}], ",", " ", 
      RowBox[{"(*", 
       RowBox[{"Create", " ", "a", " ", "point", " ", "cloud"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Dynamic", "[", " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Run", " ", "this", " ", "in", " ", "real"}], "-", 
         RowBox[{"time", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"r", "<", 
           RowBox[{"(", 
            RowBox[{"n", "/", "10"}], ")"}]}], ",", "s"}], "]"}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
           "If", " ", "a", " ", "randomly", " ", "chosen", " ", "entity", " ",
             "has", " ", "ID"}], " ", "<", " ", 
           RowBox[{"100", " ", 
            RowBox[{"(", 
             RowBox[{"10", "%", " ", "chance"}], ")"}]}]}], ",", " ", 
          RowBox[{"run", " ", "s"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Point", "[", 
         RowBox[{"x", "=", 
          RowBox[{
           RowBox[{"0.995", " ", "x"}], " ", 
           RowBox[{"(*", 
            RowBox[{
            "Multiply", " ", "coordinates", " ", "by", " ", "0.995", " ", 
             "to", " ", "move", " ", "5", "%", " ", "closer", " ", "to", " ", 
             "center"}], "*)"}], "\[IndentingNewLine]", "+", 
           RowBox[{"0.02", " ", 
            RowBox[{"f", "[", "p", "]"}]}], " ", 
           RowBox[{"(*", 
            RowBox[{"Move", " ", 
             RowBox[{"(", 
              RowBox[{"0.02", " ", "*", " ", "vector", " ", "length"}], ")"}],
              " ", "units", " ", "closer", " ", "to", " ", "\"\<friend\>\"", 
             " ", "p"}], "*)"}], "\[IndentingNewLine]", "-", 
           RowBox[{"0.01", " ", 
            RowBox[{"f", "[", "q", "]"}]}]}]}], "]"}]}], " ", 
       RowBox[{"(*", 
        RowBox[{"Move", " ", 
         RowBox[{"(", 
          RowBox[{"0.01", " ", "*", " ", "vector", " ", "length"}], ")"}], 
         " ", "units", " ", "away", " ", "from", " ", "\"\<enemy\>\"", " ", 
         "q"}], "*)"}], "\[IndentingNewLine]", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "\[Rule]", "2"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "set", " ", "the", " ", "range", " ", "of", " ", "the", " ", "graphic"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7573327524462905`*^9, 3.75733281586528*^9}, {
   3.7573328740094814`*^9, 3.757332908507985*^9}, {3.7573330690512295`*^9, 
   3.7573330719530716`*^9}, {3.7573331872896605`*^9, 3.757333267401842*^9}, {
   3.7573333140933194`*^9, 3.757333616647432*^9}, {3.757333693642826*^9, 
   3.757333802332879*^9}, {3.7573338641702843`*^9, 3.757333911172471*^9}, {
   3.7573339798844447`*^9, 3.7573340715813007`*^9}, 3.7573344319385924`*^9, {
   3.757334485831354*^9, 3.7573345194328036`*^9}, {3.7573348498987885`*^9, 
   3.7573348571689863`*^9}, {3.7573349647439704`*^9, 
   3.7573349683494186`*^9}, {3.757335009921219*^9, 3.7573350829179015`*^9}, {
   3.7573351132648373`*^9, 3.7573351304088545`*^9}, {3.7573352303815994`*^9, 
   3.7573353731759644`*^9}, {3.7573354492964664`*^9, 3.757335465855686*^9}, {
   3.7573358182556458`*^9, 3.7573359550558968`*^9}, 3.757832031384449*^9, {
   3.7578321855684967`*^9, 3.757832194447926*^9}, {3.7578426534769816`*^9, 
   3.757842769255514*^9}, {3.7578428606216626`*^9, 3.7578428889607944`*^9}, {
   3.757843953947324*^9, 3.757843954879263*^9}, {3.757845056034493*^9, 
   3.75784506194009*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"2d7da5bd-8f7d-40f3-90ec-d6e71ec06501"],

Cell["\<\

------------------

\
\>", "Text",
 CellChangeTimes->{{3.7578470382970233`*^9, 
  3.7578470423997607`*^9}},ExpressionUUID->"288bf4d1-a31e-480b-8650-\
6075c3c67c9b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"leaderCoordinates", "=", 
   RowBox[{"{", 
    RowBox[{"0.0", ",", "0.0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"count", "=", "0.0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numberOfAnimals", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mapSize", "=", "2"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Total", " ", "Map", " ", "Size"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"leaderCircleDiameter", "=", "1"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Size", " ", "of", " ", "circle", " ", "followed", " ", "by", " ", 
    "leader"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"leaderSpeed", "=", "1"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Speed", " ", "of", " ", "leader"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"leaderSpeedAngular", "=", 
   RowBox[{"leaderSpeed", "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"leaderCircleDiameter", "/", "2"}], ")"}], "*", "Pi"}], 
     ")"}]}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Converts", " ", "leader", " ", "speed", " ", "to", " ", "angular", " ", 
    "speed"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"animalCoordinates", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "mapSize"}], ",", "mapSize"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"numberOfAnimals", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"leaderCircleDiameter", ">", "mapSize"}], ",", 
     RowBox[{
     "Print", "[", "\"\<Leader is circling outside of map!\>\"", "]"}]}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Framed", "[", "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Leader", " ", "Code"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.015", "]"}], ",", "Blue", ",", 
          RowBox[{"Dynamic", "[", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"count", ">", 
               RowBox[{"2", "*", "Pi"}]}], ",", 
              RowBox[{"count", "=", "0"}], ",", 
              RowBox[{"count", "=", 
               RowBox[{"count", "+", 
                RowBox[{"leaderSpeedAngular", "*", "0.01"}]}]}]}], "]"}], ";",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"leaderCoordinates", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "=", 
             RowBox[{"leaderCircleDiameter", "*", 
              RowBox[{"Sin", "[", "count", "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"leaderCoordinates", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "=", 
             RowBox[{"leaderCircleDiameter", "*", 
              RowBox[{"Cos", "[", "count", "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Point", "[", "leaderCoordinates", "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", "mapSize"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
       "]"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Follower", " ", "Code"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Closes", " ", "Framed"}], " ", "&"}], " ", "Show"}], " ", 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7578439831534452`*^9, 3.7578439968095675`*^9}, {
   3.757844031239354*^9, 3.7578441202116346`*^9}, {3.757844298747155*^9, 
   3.7578443042777996`*^9}, {3.7578443438103023`*^9, 
   3.7578443547095575`*^9}, {3.757844395413943*^9, 3.7578444049613266`*^9}, {
   3.7578444562460747`*^9, 3.7578444874890213`*^9}, {3.7578448260612974`*^9, 
   3.7578448549873934`*^9}, {3.757844917281433*^9, 3.757844933060419*^9}, {
   3.7578449654793344`*^9, 3.757845018512924*^9}, {3.757845102117505*^9, 
   3.7578452609032965`*^9}, {3.757845292764247*^9, 3.7578455074114475`*^9}, 
   3.757845538481449*^9, {3.757845741314409*^9, 3.7578457822657757`*^9}, {
   3.757845908905634*^9, 3.757845937478797*^9}, {3.757845971662599*^9, 
   3.757846089846001*^9}, {3.757846170416822*^9, 3.757846230117983*^9}, {
   3.7578464679346933`*^9, 3.7578466993478146`*^9}, {3.757846881804128*^9, 
   3.757846888158678*^9}, {3.757846919716646*^9, 3.7578469806657305`*^9}, {
   3.7578470180533705`*^9, 3.757847018166317*^9}, {3.757847069216055*^9, 
   3.7578472599728136`*^9}, 3.757847296517468*^9, {3.757847346920226*^9, 
   3.757847505820964*^9}, 3.7578475581136045`*^9, {3.7578475925594115`*^9, 
   3.7578476463569293`*^9}, {3.7578476960767765`*^9, 
   3.7578477879958224`*^9}, {3.7578478638499455`*^9, 
   3.7578478769101057`*^9}, {3.75784798945087*^9, 3.757848093544224*^9}, {
   3.7578481725521436`*^9, 3.757848242903578*^9}, {3.757848277900325*^9, 
   3.7578482877526913`*^9}, {3.757849086909357*^9, 3.757849168192103*^9}, {
   3.757849206934595*^9, 3.757849233319944*^9}, {3.7578492891243114`*^9, 
   3.75784929325109*^9}, {3.75784934232689*^9, 3.7578493438007956`*^9}, {
   3.75784949071235*^9, 3.757849543277971*^9}, {3.7578496532069035`*^9, 
   3.757849721654504*^9}},
 CellLabel->
  "In[504]:=",ExpressionUUID->"4bc5907d-ffc6-47b5-8503-12f87f940e1b"],

Cell[BoxData[
 FrameBox[
  GraphicsBox[
   {RGBColor[0, 0, 1], PointSize[0.015], 
    DynamicBox[Typeset`ToBoxes[
     If[$CellContext`count > 2 Pi, $CellContext`count = 
        0, $CellContext`count = $CellContext`count + \
$CellContext`leaderSpeedAngular 0.01]; 
      Part[$CellContext`leaderCoordinates, 
         1] = $CellContext`leaderCircleDiameter Sin[$CellContext`count]; 
      Part[$CellContext`leaderCoordinates, 
         2] = $CellContext`leaderCircleDiameter Cos[$CellContext`count]; 
      Point[$CellContext`leaderCoordinates], StandardForm, Graphics],
     ImageSizeCache->{{310.5471028328461, 319.1871028328461}, {
      134.15140624652486`, 142.79140624652484`}}]},
   ImageSize->Large,
   PlotRange->2],
  StripOnInput->False]], "Output",
 CellChangeTimes->{{3.75784966265932*^9, 3.757849678445281*^9}, 
   3.7578497309949017`*^9},
 CellLabel->
  "Out[509]=",ExpressionUUID->"9afbffc5-796d-4fb8-a88f-eb68f75f6520"]
}, Open  ]]
},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 8481, 212, 542, "Input",ExpressionUUID->"2d7da5bd-8f7d-40f3-90ec-d6e71ec06501"],
Cell[9042, 234, 175, 8, 100, "Text",ExpressionUUID->"288bf4d1-a31e-480b-8650-6075c3c67c9b"],
Cell[CellGroupData[{
Cell[9242, 246, 5820, 128, 561, InheritFromParent,ExpressionUUID->"4bc5907d-ffc6-47b5-8503-12f87f940e1b"],
Cell[15065, 376, 937, 21, 607, "Output",ExpressionUUID->"9afbffc5-796d-4fb8-a88f-eb68f75f6520"]
}, Open  ]]
}
]
*)

